# MacOS 在线取证

Apple 系列设备在取证时，要尽可能快地断掉网络，避免被远程擦除。

macOS 10.12 及以上版本需要关闭 `系统完整性保护（SIP）` 才能够获取到内存和磁盘镜像。检测方式：

```
csrutil status
```

MacOS 因为系统机制的问题，采集到的数据往往不全，而且也可能很难解析，所以应该在开机的时候尽可能固定多的证据（导出 & 拍摄），避免给后期工作增加麻烦。

以下是 MacOS 在线取证中常用的命令，其中多数还是和 Linux、Unix 下的操作一致。

| **操作要求**                             | **命令**            |
| ---------------------------------------- | ------------------- |
| 显示系统当前的日期和时间                 | date                |
| 显示主机名                               | hostname            |
| 显示操作系统的有关信息（主要是内核信息） | uname -a            |
| 显示操作系统版本                         | sw_vers             |
| 列出当前登录的所有用户                   | who                 |
| 显示当前正进行操作的用户名               | whoami              |
| 列出用户登录信息                         | last                |
| 列出最近执行过的命令及编号               | history             |
| 显示当前系统活动的总信息                 | w                   |
| 显示打开的文件                           | lsof \| more        |
| 显示运行的进程                           | ps aux \| more      |
| 显示进程的活动网络连接                   | lsof -i             |
| 显示网络配置信息                         | ifconfig            |
| 显示路由表                               | netstat -rn \| more |
| 显示ARP表                                | arp -an             |