### 参考WP
[长安杯2021赛题复现详解 - 腾讯云开发者社区-腾讯云](https://cloud.tencent.com/developer/article/2272895)<br />[2021长安杯复盘学习 - d3f4u1t - 博客园](https://www.cnblogs.com/perfectcqf/p/16806059.html)<br />[2021长安杯 - XDforensics-Wiki](https://forensics.xidian.edu.cn/wiki/2021caWriteUp/#_4)
## 题目背景
2021年4月25日，上午8点左右，警方接到被害人金某报案，声称自己被敲诈数万元；经询问，昨日金某被嫌疑人诱导裸聊， 下载了某“裸聊”软件，导致自己的通讯录和裸聊视频被嫌疑人获取，对其进行敲诈，最终金某不堪重负，选择了报警；警 方从金某提供的本人手机中，定向采集到了该“裸聊”软件的安装包--zhibo.apk（检材一），请各位回答下列问题：（题目 中需要通过分析出来的答案对检材二三四五解压，解压密码为IP的情况，需要在密码后增加-CAB2021，例： 192.168.100.100-CAB2021）
## Part1 APK分析
### 1. 请计算检材一Apk的SHA256值
3fece1e93be4f422c8446b77b6863eb6a39f19d8fa71ff0250aac10f8bdde73a
### 2. 该APK的应用包名为
plus.H5B8E45D3
### 3. 该APK程序在封装服务商的应用唯一标识（APPID）为
H5B8E45D3
### 4. 该APK具备下列哪些危险权限：
A、读取短信 <br />B、读取通讯录 <br />C、读取精确位置 <br />D、修改通讯录 <br />E、修改短信
### 5. 该APK发送回后台服务器的数据包含以下哪些内容：
A.手机通讯录 <br />B.手机应用列表 <br />C.手机号码 <br />D.验证码<br />E.GPS 定位信息
### 6. 该APK程序回传通讯录时,使用的http请求方式为
POST
### 7. 该APK程序的回传地址域名为【标准格式：www.abc.com】

### 8. 该APK程序代码中配置的变量apiserver的值为【标准格式：www.abc.com/abc】

### 9. 分析该APK，发现该程序还具备获取短信回传到后台的功能，短信上传服务器接口地址为【标准格式：www.abc.com/abc】

### 10. 经分析，发现该APK在运行过程中会在手机中产生一个数据库文件，该文件的文件名为
test.db
### 11. 经分析，发现该APK在运行过程中会在手机中产生一个数据库文件，该数据库的初始密码为
c74d97b01eae257e44aa9d5bade97baf
## Part2 [负载均衡](https://cloud.tencent.com/product/clb?from=20065&from_column=20065)服务器分析
**经过掌握的APK程序后台服务器回连地址，警方成功调取该服务器的镜像，请使用第7题的答案对检材二进行解压进行分析，并回答下列问题：**
### 12. 检材二的原始硬盘的SHA256值为
E6873068B83AF9988D297C6916329CEC9D8BCB672C6A894D393E68764391C589
### 13. 查询涉案于案发时间段内登陆服务器的IP地址为【标准格式：111.111.111.111】
192.168.110.203
### 14. 请对检材二进行分析，并回答该服务器在集群中承担的主要作用是【格式：文件存储】
负载均衡
### 15. 上一题中，提到的主要功能对应的服务监听的端口为
80
### 16. 上一题中，提到的服务所使用的启动命令为
node app.js
### 17. 经分析，该服务对于请求来源IP的处理依据是：根据请求源IP地址的第几位进行判断【标准格式：9】
3
### 18. 经分析，当判断条件小于50时，服务器会将该请求转发到IP为___的服务器上【标准格式：111.111.111.111】
192.168.110.111
### 19. 请分析，该服务器转发的目标服务器一共有几台【标准格式：9】
3
### 20. 请分析，受害者通讯录被获取时，其设备的IP地址为【标准格式：111.111.111.111】
192.168.110.252
### 21. 请分析，受害者的通讯录被窃取之后，经由该服务器转发到了IP为___的服务器上【标准格式：111.111.111.111】
192.168.110.113
## Part3 目标服务器分析
通过对检材二的分析，警方进一步掌握并落地到了目标服务器地址，通过对服务器进行证据固定，得到服务器镜像--检材三，请使用第21题答案对检材三进行解密并分析，回答下列问题：
### 22. 检材三的原始硬盘的SHA256值为
205C1120874CE0E24ABFB3BB1525ACF330E05111E4AD1D323F3DEE59265306BF
### 23. 请分析第21题中，所指的服务器的开机密码为

### 24. 嫌疑人架设网站使用了宝塔面板，请问面板的登陆用户名为
hl123
### 25. 请分析用于重置宝塔面板密码的函数名为
set_panel_pwd
### 26. 请分析宝塔面板登陆密码的加密方式所使用的哈希算法为
md5
### 27. 请分析宝塔面板对于其默认用户的密码一共执行了几次上题中的哈希算法
3
### 28. 请分析当前宝塔面板密码加密过程中所使用的salt值为【区分大小写】
v87ilhAVumZL
### 29. 请分析该服务器，网站源代码所在的绝对路径为
/www/wwwroot/www.honglian7001
### 30. 请分析，网站所使用的数据库位于IP为___的服务器上（请使用该IP解压检材5，并重构网站）【标准格式：111.111.111.111】
192.168.110.115
### 31. 请分析，数据库的登陆密码为【区分大小写】
wxrM5GtNXk5k5EPX
### 32. 请尝试重构该网站，并指出，该网站的后台管理界面的入口为【标准格式：/web】
/admin
### 33. 已知该涉案网站代码中对登录用户的密码做了加密处理。请找出加密算法中的salt值【区分大小写】
lshi4AsSUrUOwWV
### 34. 请分析该网站的管理员用户的密码为：
security
### 35. 在对后台账号的密码加密处理过程中，后台一共计算几次哈希值
3
### 36. 请统计，后台中，一共有多少条设备记录
6002
### 37. 请通过后台确认，本案中受害者的手机号码为
18644099137
### 38. 请分析，本案中受害者的通讯录一共有多少条记录
34
## Part4 PC&手机分析
通过对检材二和三进行分析，警方通过IP落地，警方掌成功抓获犯罪嫌疑人，现将嫌疑人的PC机和手机进行了取证，分别制作了镜像，请使用第13题的答案对检材四进行解密，并回答下列问题：
### 39. 请计算检材四-PC的原始硬盘的SHA256值

### 40. 请分析，检材四-PC的Bitlocker加密分区的解密密钥为

### 41. 请分析，检材四-PC的开机密码为

### 42. 经分析发现，检材四-PC是嫌疑人用于管理服务器的设备，其主要通过哪个浏览器控制网站后

### 43. 请计算PC检材中用户目录下的zip文件的sha256值

### 44. 请分析检材四-phone，该手机的IMEI号为

### 45. 请分析检材四-phone，嫌疑人和本案受害者是通过什么软件开始接触的【标准格式：支付宝】

### 46. 请分析检材四-phone，受害者下载恶意APK安装包的地址为

### 47. 请分析检材四-phone，受害者的微信内部ID号为

### 48. 请分析检材四-phone，嫌疑人用于敲诈本案受害者的QQ账号为

### 49. 请综合分析，嫌疑人用于管理敲诈对象的容器文件的SHA256值为

### 50. 请综合分析嫌疑人检材，另外一受害者“郭先生”的手机号码为

### 51. 通过嫌疑人检材，其中记录了几位受害者的信息

### 52. 请使用第11题的密码解压“金先生转账.zip”文件，并对压缩包中的文件计算SHA256值

### 53. 请综合分析，受害者一共被嫌疑人敲诈了多少钱（转账截图被隐藏在多个地方）

